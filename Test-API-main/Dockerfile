# Базовый образ Python версии 3.11 в slim-варианте (уменьшенный размер)
FROM python:3.11-slim

# Установка рабочей директории внутри контейнера
WORKDIR /app

# Копирование файла зависимостей в текущую директорию контейнера (/app)
COPY requirements.txt .

# Установка Python-зависимостей без кеширования пакетов (для уменьшения размера образа)
RUN pip install --no-cache-dir -r requirements.txt

# Копирование основного файла приложения в рабочую директорию контейнера
COPY main.py .

# Открытие порта 8000 для доступа к приложению извне контейнера
EXPOSE 8000

# Команда запуска приложения с помощью Uvicorn сервера
# --host 0.0.0.0: доступ со всех сетевых интерфейсов
# --port 8000: порт приложения
# --reload: автоматическая перезагрузка при изменении кода (для разработки)
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]

# /*
# ===========================================
# ПОЯСНЕНИЯ К КОММЕНТАРИЯМ В ДАННОМ ФАЙЛЕ:
# ===========================================

# 1. Dockerfile - инструкция для сборки Docker-образа приложения

# 2. Комментарий "Базовый образ Python..." - объясняет выбор официального образа Python
# версии 3.11 с slim-сборкой (минимальный размер, только необходимые компоненты)

# 3. Комментарий "Установка рабочей директории..." - описывает создание директории /app
# внутри контейнера как рабочей папки для приложения

# 4. Комментарий "Копирование файла зависимостей..." - поясняет перенос файла requirements.txt
# из локальной системы в контейнер для последующей установки зависимостей

# 5. Комментарий "Установка Python-зависимостей..." - описывает установку пакетов из
# requirements.txt без сохранения кеша (оптимизация размера конечного образа)

# 6. Комментарий "Копирование основного файла..." - поясняет добавление основного
# Python-файла приложения в образ

# 7. Комментарий "Открытие порта 8000..." - указывает что контейнер предоставляет
# доступ к порту 8000 для внешних подключений

# 8. Комментарий "Команда запуска приложения..." - описывает запуск Uvicorn сервера
# с параметрами: хост 0.0.0.0 (доступ снаружи), порт 8000, режим перезагрузки

# ТЕХНИЧЕСКИЕ ДЕТАЛИ:
# - Uvicorn: ASGI-сервер для запуска FastAPI/Starlette приложений
# - --reload: используется только в разработке, в production следует убрать
# - slim-образ: уменьшает размер итогового Docker-образа на сотни мегабайт
# */


